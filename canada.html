<!DOCTYPE html>
<meta charset="utf-8">
<html>
    <body>

    </body>

    <style>

    /* CSS goes here. */

    .subunit {
        fill: #b0d0ab;
        stroke: #6cb0e0;
        stroke-width: 0.5px;
        stroke-linecap: round;
        stroke-linejoin: round;
        vector-effect: non-scaling-stroke;
    }

    .drive {
        fill: none;
        stroke: #111;
    }


    </style>

    <script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
    <script src="http://d3js.org/topojson.v1.min.js"></script>

    <script>
        var width = 960,
            height = 1160;

        var data;

        var projection = d3.geo.transverseMercator()
            .rotate([105, -70])
            .center([7, -22])
            .scale(1100)
            .translate([width / 2, height / 2])
            .precision(.1)
            .clipAngle(70);

        var path = d3.geo.path()
            .projection(projection);

        var svg = d3.select("body").append("svg")
            .attr("width", width)
            .attr("height", height)


        d3.json("canada.json", function(error, canada){
            if (error) return console.error(error);

            data = canada;

            var subunits = topojson.feature(canada, canada.objects.subunits)
            var places = topojson.feature(canada, canada.objects.places)

            svg.append("path")
                .datum(subunits)
                .attr("d", path);

            svg.selectAll(".subunit")
                .data(topojson.feature(canada, canada.objects.subunits).features)
              .enter().append('path')
                .attr("class", function(d){ return "subunit " + d.id; })
                .attr("d", path);

            svg.append("path")
                .datum(places)
                .attr("d", path)
                .attr("class", "place");

            svg.selectAll(".place-label")
                .data(topojson.feature(canada, canada.objects.places).features)
              .enter().append('text')
                .attr("class", "place-label")
                .attr("transform", function(d) { return "translate(" + projection(d.geometry.coordinates) + ")"; } )
                .attr('dy', '.35em')
                .text(function(d){ return d.properties.name })
                .attr("x", function(d) { return d.geometry.coordinates[0] > -1 ? 6 : -6; })
                .style("text-anchor", function(d) { return d.geometry.coordinates[0] > -1 ? "start" : "end"; });



        });

        var route;
        d3.json("topopath.json", function(error, data){
            if (error) return console.error(error);

            route = data;

            var drive = topojson.feature(data, data.objects.path);


            svg.append("path")
	      	   .datum(topojson.mesh(data))
	           .attr("d", path)
               .attr("class", "drive");

        });
    </script>
</html>
